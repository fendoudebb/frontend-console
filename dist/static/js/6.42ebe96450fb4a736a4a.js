webpackJsonp([6],{"7PXo":function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=t("Dd8w"),n=t.n(a),i={name:"message-detail",props:{row:Object}},r={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("span",{staticClass:"expand-key"},[e._v("ID: ")]),e._v(" "),t("span",{staticClass:"expand-value"},[e._v(e._s(e.row.id))]),e._v(" "),t("br"),e._v(" "),t("br"),e._v(" "),t("span",{staticClass:"expand-key"},[e._v("IP: ")]),e._v(" "),t("span",{staticClass:"expand-value"},[e._v(e._s(e.row.ip))]),e._v(" "),t("br"),e._v(" "),t("br"),e._v(" "),t("span",{staticClass:"expand-key"},[e._v("留言内容: ")]),e._v(" "),t("span",{staticClass:"expand-value"},[e._v(e._s(e.row.content))]),e._v(" "),t("br"),e._v(" "),t("br"),e._v(" "),t("span",{staticClass:"expand-key"},[e._v("User-Agent: ")]),e._v(" "),t("span",{staticClass:"expand-value"},[e._v(e._s(e.row.userAgent))]),e._v(" "),t("br"),e._v(" "),t("br"),e._v(" "),e._l(e.row.reply,function(s,a){return t("div",{key:a},[t("span",{staticClass:"expand-key"},[e._v("回复内容: ")]),t("span",{staticClass:"expand-value"},[e._v(e._s(s.content))]),e._v(" "),t("br"),e._v(" "),t("span",{staticClass:"expand-key"},[e._v("时间: ")]),t("span",{staticClass:"expand-value"},[e._v(e._s(new Date(1e3*s.commentTime.$date.$numberLong).toLocaleString()))]),e._v(" "),t("br"),e._v(" "),t("span",{staticClass:"expand-key"},[e._v("浏览器: ")]),t("span",{staticClass:"expand-value"},[e._v(e._s(s.browser))]),e._v(" "),t("br"),e._v(" "),t("span",{staticClass:"expand-key"},[e._v("ip: ")]),t("span",{staticClass:"expand-value"},[e._v(e._s(s.ip))]),e._v(" "),t("br"),e._v(" "),t("br")])})],2)},staticRenderFns:[]};var o=t("VU/8")(i,r,!1,function(e){t("k/TW")},"data-v-002ca8f5",null).exports,l=t("SJI6"),c={name:"message-board",components:{expandRow:o},data:function(){var e=this;return{roles:localStorage.getItem("roles"),messageListTableLoading:!1,messageList:[],messageListColumns:[{type:"expand",width:50,render:function(e,s){return e(o,{props:{row:s.row}})}},{title:"楼层",key:"floor",align:"center",ellipsis:!0,minWidth:150},{title:"昵称",key:"nickname",align:"center",ellipsis:!0,minWidth:150},{title:"留言时间",key:"commentTime",align:"center",ellipsis:!0,minWidth:150},{title:"浏览器",key:"browser",align:"center",ellipsis:!0,minWidth:150},{title:"操作系统",key:"os",align:"center",ellipsis:!0,minWidth:150},{title:"状态",key:"status",align:"center",ellipsis:!0,minWidth:150,render:function(e,s){var t=s.row.status,a="",n="";return"ONLINE"===t?(a="上线",n="green"):"OFFLINE"===t&&(a="下线",n="red"),e("Tag",{props:{color:n}},a)}},{title:"操作",key:"action",align:"center",ellipsis:!0,minWidth:150,render:function(s,t){var a=[];if(e.roles.indexOf("ROLE_ADMIN")>-1){var n=s("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.replyMessage(t)}}},"回复"),i=s("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.deleteMessage(t)}}},"删除");a.push(n),a.push(i)}return s("div",[a])}}]}},methods:n()({},Object(l.mapMutations)(["setMessageBoardListPage","setMessageId","setReplyMessageId","setReplyContent"]),Object(l.mapGetters)(["getMessageBoardListSize"]),Object(l.mapActions)(["handleMessageBoardList","handleDeleteMessage","handleReplyMessage"]),{replyMessage:function(e){var s=this;this.$Modal.confirm({render:function(e){return e("Input",{props:{value:s.reply,autofocus:!0,placeholder:"请输入回复..."},on:{input:function(e){s.reply=e}}})},onOk:function(){s.setReplyMessageId(e.row.id),s.setReplyContent(s.reply),s.handleReplyMessage().then(function(e){s.reply="",s.$Message.success("回复成功！"),s.getMessageBoardList()})}})},deleteMessage:function(e){var s=this;this.$Modal.confirm({title:"删除留言",content:"是否删除"+e.row.nickname+"用户的留言？",okText:"确认删除",closable:!0,onOk:function(){s.setMessageId(e.row.id),s.handleDeleteMessage().then(function(e){s.$Message.success("删除成功！"),s.getMessageBoardList()})}})},changePage:function(e){this.setMessageBoardListPage(e),this.getMessageBoardList()},getMessageBoardList:function(){var e=this;this.messageListTableLoading=!0,this.handleMessageBoardList().then(function(s){e.totalCount=s.data.totalCount,e.messageList=s.data.comments,e.messageListTableLoading=!1}).catch(function(s){e.messageListTableLoading=!1})}}),created:function(){this.getMessageBoardList()}},d={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticStyle:{margin:"20px",padding:"20px","background-color":"white"}},[t("Table",{attrs:{border:"",stripe:"",data:e.messageList,columns:e.messageListColumns,loading:e.messageListTableLoading}}),e._v(" "),t("div",{staticStyle:{margin:"20px",overflow:"hidden"}},[t("Page",{attrs:{"page-size":e.pageSize,total:e.totalCount,current:e.currentPage,"show-elevator":"","show-total":""},on:{"on-change":e.changePage}})],1)],1)},staticRenderFns:[]};var p=t("VU/8")(c,d,!1,function(e){t("td4B")},"data-v-4252dcae",null);s.default=p.exports},"k/TW":function(e,s){},td4B:function(e,s){}});
//# sourceMappingURL=6.42ebe96450fb4a736a4a.js.map
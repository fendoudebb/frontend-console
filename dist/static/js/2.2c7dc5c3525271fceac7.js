webpackJsonp([2],{Ahni:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("Dd8w"),o=s.n(n),i=s("tr3/"),a=s("SJI6"),r={name:"post-list",components:{expandRow:i.a},data:function(){var t=this;return{postListTableLoading:!1,roles:localStorage.getItem("roles"),pageSize:this.getListSize(),totalCount:1,currentPage:1,postList:[],postListColumns:[{type:"expand",width:50,render:function(t,e){return t(i.a,{props:{row:e.row}})}},{title:"ID",key:"postId",align:"center"},{title:"标题",key:"title",align:"center"},{title:"分类",key:"topics",align:"center",render:function(e,s){var n=s.row.topics;if(null!=n){var o=n.map(function(n){return e("Tag",{props:{color:"green",type:"border",closable:!0},on:{"on-close":function(){t.$Modal.confirm({title:"删除分类",content:"是否删除《"+s.row.title+"》一文的"+n+"分类？",okText:"确认删除",closable:!0,onOk:function(){t.setDeleteTopicPostId(s.row.id),t.setDeleteTopic(n),t.handleDeletePostTopic().then(function(e){s.row.topics.splice(s.row.topics.indexOf(n),1),t.$Message.success("删除成功！")})}})}}},n)});return n.length<3&&o.push(e("Button",{props:{type:"primary",size:"small"},on:{click:function(){t.addTopicFunc(s.row)}}},"添加")),e("div",o)}return e("Button",{props:{type:"primary",size:"small"},on:{click:function(){t.addTopicFunc(s.row)}}},"添加")}},{title:"阅读数",key:"pv",align:"center"},{title:"状态",key:"postStatus",align:"center",render:function(t,e){var s=e.row.postStatus,n="",o="";return"AUDIT"===s?(n="待审核",o="orange"):"ONLINE"===s?(n="上线",o="green"):"OFFLINE"===s?(n="下线",o="red"):"PRIVATE"===s?(n="私人",o="lightskyblue"):"DRAFT"===s&&(n="草稿",o="lightskyblue"),t("Tag",{props:{color:o}},n)}},{title:"操作",key:"action",align:"center",render:function(e,s){var n=[];if(t.roles.indexOf("ROLE_ADMIN")>-1){var o=s.row.postStatus,i=e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.online(s.index)}}},"上线"),a=e("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.offline(s.index)}}},"下线");"AUDIT"===o||"OFFLINE"===o?n.push(i):"ONLINE"===o&&n.push(a)}var r=e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.edit(s.row.id)}}},"编辑");return n.push(r),e("div",[n])}}]}},methods:o()({},Object(a.mapMutations)(["setListPage","setAuditPostId","setAuditStatus","setEditPostId","setAddTopicPostId","setDeleteTopicPostId","setAddTopic","setDeleteTopic"]),Object(a.mapGetters)(["getListSize"]),Object(a.mapActions)(["handlePostList","handlePostStatus","handleAddPostTopic","handleDeletePostTopic"]),{addTopicFunc:function(t){var e=this;this.$Modal.confirm({render:function(t){return t("Input",{props:{value:e.newTopic,autofocus:!0,placeholder:"请输入分类名..."},on:{input:function(t){e.newTopic=t}}})},onOk:function(){e.setAddTopicPostId(t.id),e.setAddTopic(e.newTopic),e.handleAddPostTopic().then(function(s){t.hasOwnProperty("topics")?t.topics.push(e.newTopic):t.topics=[e.newTopic],e.newTopic="",e.$Message.success("添加成功！")})}})},online:function(t){this.modifyPostStatus(t,"ONLINE")},offline:function(t){this.modifyPostStatus(t,"OFFLINE")},edit:function(t){this.setEditPostId(t),this.$router.push({name:"publish_index"})},modifyPostStatus:function(t,e){var s=this,n=this.postList[t];this.setAuditPostId(n.id),this.setAuditStatus(e),this.handlePostStatus().then(function(n){s.postList[t].postStatus=e,"ONLINE"===e?s.$Message.success("文章上线成功!"):"OFFLINE"===e&&s.$Message.warning("文章已下线!")})},changePage:function(t){this.setListPage(t),this.getPostList()},getPostList:function(){var t=this;this.postListTableLoading=!0,this.handlePostList().then(function(e){t.totalCount=e.data.totalCount,t.postList=e.data.post,t.postListTableLoading=!1}).catch(function(e){t.postListTableLoading=!1})}}),created:function(){this.getPostList()},mounted:function(){}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Table",{attrs:{border:"",stripe:"",data:t.postList,columns:t.postListColumns,loading:t.postListTableLoading}}),t._v(" "),s("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[s("div",{staticStyle:{float:"right"}},[s("Page",{attrs:{"page-size":t.pageSize,total:t.totalCount,current:t.currentPage,"show-elevator":"","show-total":""},on:{"on-change":t.changePage}})],1)])],1)},staticRenderFns:[]};var p=s("VU/8")(r,c,!1,function(t){s("zeLB")},"data-v-7eb91e2c",null);e.default=p.exports},Zl7t:function(t,e){},"tr3/":function(t,e,s){"use strict";var n={name:"post-detail",props:{row:Object}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("span",{staticClass:"expand-key"},[t._v("作者: ")]),t._v(" "),s("span",{staticClass:"expand-value"},[t._v(t._s(t.row.sysUser.username))]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"expand-key"},[t._v("评论数: ")]),t._v(" "),s("span",{staticClass:"expand-value"},[t._v(t._s(t.row.commentCount))]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"expand-key"},[t._v("点赞数: ")]),t._v(" "),s("span",{staticClass:"expand-value"},[t._v(t._s(t.row.likeCount))]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"expand-key"},[t._v("创建时间: ")]),t._v(" "),s("span",{staticClass:"expand-value"},[t._v(t._s(t.row.postTime))]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"expand-key"},[t._v("是否原创: ")]),t._v(" "),s("span",{staticClass:"expand-value"},[t._v(t._s("COPY"===t.row.postProp?"转载":"原创"))]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"expand-key"},[t._v("是否公开: ")]),t._v(" "),s("span",{staticClass:"expand-value"},[t._v(t._s("PRIVATE"===t.row.postStatus?"个人":"公开"))])])},staticRenderFns:[]};var i=s("VU/8")(n,o,!1,function(t){s("Zl7t")},"data-v-498e2e08",null);e.a=i.exports},zeLB:function(t,e){}});
//# sourceMappingURL=2.2c7dc5c3525271fceac7.js.map